!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="dist",t(0)}([function(e,t,r){"use strict";var n=r(5);"undefined"!=typeof e&&"undefined"!=typeof e.exports?e.exports=n:window.PeerCustomMesg=n},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function o(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,o,a,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[e],i(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(s(r))for(a=Array.prototype.slice.call(arguments,1),c=r.slice(),o=c.length,u=0;o>u;u++)c[u].apply(this,a);return!0},r.prototype.addListener=function(e,t){var o;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(o=i(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),o||(o=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var o=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var r,o,i,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],i=r.length,o=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(r)){for(a=i;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){o=a;break}if(0>o)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var o=r(10),s=n(o),i={make_transaction_id:function(){return(0,s["default"])(i.make_utc_timestamp())},make_utc_timestamp:function(){return Date.now().toString()}};e.exports=i},function(e,t){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},n={is_boolean:function(e){return"boolean"==typeof e},is_falsy:function(e){return 0===e?!1:!e},is_transaction_id:function(e){return"string"!=typeof e?!1:!!e.match(/^[a-z0-9]{32}$/)},is_signalling_type:function(e){return!("string"!=typeof e||!e.match(/^(PING|OFFER|ANSWER|CANDIDATE)$/))},is_peer_object:function(e){return!(!e||!e.toString||"[object Object]"!==e.toString())},is_string:function(e,t,r){if("string"!=typeof e)return!1;var n="number"==typeof t,o="number"==typeof r;if((n||o)&&(!n||!o))return!1;if("number"==typeof t||"number"==typeof r){if(t===r)return!1;if(t>r)return!1;if(e.length<t||e.length>r)return!1}return!0},is_peerid:function(e){return"string"!=typeof e?!1:0!==e.length},is_object:function(e){return n.is_falsy(e)?!1:"object"===("undefined"==typeof e?"undefined":r(e))},is_peerjs_format:function(e){return"string"!=typeof e.type?!1:n.is_falsy(e.payload)?!1:n.is_peerid(e.dst)&&n.is_peerid(e.src)?e.dst!==e.src:!1}};e.exports=n},function(e,t){var r={utf8:{stringToBytes:function(e){return r.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(r.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};e.exports=r},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(1),c=n(u),f=r(3),p=n(f),l=r(6),h=n(l),d=r(7),y=n(d),m=function(e){function t(e,r){o(this,t);var n=s(this,Object.getPrototypeOf(t).call(this));if(!p["default"].is_peer_object(e))throw"parameter peer does not valid object";if(r&&!p["default"].is_string(r))throw"parameter custom_type should be string";return n.peer=e,n.custom_type=r?"X_"+r.toUpperCase():"X_CUSTOMMESG",n.objRequests={},n.peer.socket.on("message",function(e){if(p["default"].is_signalling_type(e.type))return void n.emit("signalling-mesg",e.type);if(e.type!==n.custom_type)throw"received type does not match with custom_type: "+e.type;if(!p["default"].is_peerjs_format(e))throw"data type is not valid peerjs format";if(e.payload.name&&"request"===e.payload.name&&e.payload.method&&e.payload.resource&&e.payload.transaction_id){var t=e.payload,r={transaction_id:t.transaction_id,dst:e.src,method:t.method,resource:t.resource,parameter:t.parameter},o=new y["default"](r).once("send-ready",function(){n.send(o.dst,o.data)}),s={method:t.method,resource:t.resource,parameter:t.parameter};n.emit("request",s,o)}else if(e.payload.name&&"response"===e.payload.name&&e.payload.status&&e.payload.method&&e.payload.resource&&e.payload.transaction_id&&e.payload.response){var o=e.payload;if(!n.objRequests[o.transaction_id])throw"transaction_id does not exist: "+o.transaction_id;var t=n.objRequests[o.transaction_id];if(o.method!==t.method)throw"res.method does not match with req.method: "+o.method;if(o.resource!==t.resource)throw"res.resource does not match with req.resource: "+o.resource;var i={status:o.status,method:o.method,resource:o.resource,parameter:o.parameter,response:o.response};"200"===i.status?t.resolve(i):t.reject(i.status+" : "+i.response),delete n.objRequests[o.transaction_id]}else n.emit("message",{srcPeerID:e.src,data:e.payload})}),n}return i(t,e),a(t,[{key:"send",value:function(e,t){if(!p["default"].is_peerid(e))throw"parameter dst is not valid peer id";if(p["default"].is_falsy(t))throw"parameter mesg is falsy";this.peer.socket.send({type:this.custom_type,payload:t,dst:e})}},{key:"rpc",value:function(e,t,r,n){var o=this,s=new h["default"]({method:e,dst:t,resource:r,parameter:n,resolve:null,reject:null}),i=new Promise(function(n,i){s.resolve=n,s.reject=i;var a=s.transaction_id;o.objRequests[a]=s,o.send(t,s.data),o.emit("rpc-called",{method:e,resource:r,dst:t})});return i}},{key:"get",value:function(e,t,r){return this.rpc("GET",e,t,r)}}]),t}(c["default"]);e.exports=m},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(1),u=r(2),c=function(e){function t(e){n(this,t);var r=o(this,Object.getPrototypeOf(t).call(this));if(!r.validate_param(e))throw"Request: parameter for constructor is not valid";return r.transaction_id=u.make_transaction_id(),r.created_at=u.make_utc_timestamp(),r.dst=e.dst,r.method=e.method,r.resource=e.resource,r.parameter=e.parameter,r.resolve=e.resolve,r.reject=e.reject,r.data={name:"request",method:e.method,resource:e.resource,parameter:e.parameter,transaction_id:r.transaction_id},r}return s(t,e),i(t,[{key:"validate_param",value:function(e){return e.method&&"string"==typeof e.method?(e.method=e.method.toUpperCase(),e.method.match(/^(GET|POST|PUT|DELETE)$/)&&e.dst&&"string"==typeof e.dst&&e.resource&&"string"==typeof e.resource&&e.resource.match(/^\/[0-9a-zA-Z-]+$/)?e.resolve&&"function"!=typeof e.resolve?!1:!e.reject||"function"==typeof e.reject:!1):!1}}]),t}(a);e.exports=c},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(1),u=r(2),c=r(3),f=function(e){function t(e){n(this,t);var r=o(this,Object.getPrototypeOf(t).call(this));if(!r._validate_param(e))throw"Response: parameter for constructor is not valid";return r.transaction_id=e.transaction_id,r.created_at=u.make_utc_timestamp(),r.dst=e.dst,r.method=e.method,r.resource=e.resource,r.parameter=e.parameter,r.data={status:"200",name:"response",method:e.method,resource:e.resource,transaction_id:e.transaction_id,response:""},r}return s(t,e),i(t,[{key:"status",value:function(e){if("number"!=typeof e)throw"status code should be number";if(100>e||e>999)throw"status code should be between 100 - 999";this.data.status=e.toString()}},{key:"write",value:function(e){if(null===e||void 0===e)throw"data should be specified";this.data.response=e}},{key:"end",value:function(){this.emit("send-ready")}},{key:"_validate_param",value:function(e){return e.transaction_id&&c.is_transaction_id(e.transaction_id)&&e.method&&"string"==typeof e.method&&e.method.match(/^(GET|POST|PUT|DELETE)$/)&&e.dst&&"string"==typeof e.dst?!(!e.resource||"string"!=typeof e.resource||!e.resource.match(/^\/[0-9a-zA-Z-]+$/)):!1}}]),t}(a);e.exports=f},function(e,t){!function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&r.rotl(e,8)|4278255360&r.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=r.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,n=0;r<e.length;r++,n+=8)t[n>>>5]|=e[r]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var r=[],n=0;n<e.length;n+=3)for(var o=e[n]<<16|e[n+1]<<8|e[n+2],s=0;4>s;s++)8*n+6*s<=8*e.length?r.push(t.charAt(o>>>6*(3-s)&63)):r.push("=");return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var r=[],n=0,o=0;n<e.length;o=++n%4)0!=o&&r.push((t.indexOf(e.charAt(n-1))&Math.pow(2,-2*o+8)-1)<<2*o|t.indexOf(e.charAt(n))>>>6-2*o);return r}};e.exports=r}()},function(e,t){e.exports=function(e){return!(null==e||!(e._isBuffer||e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)))}},function(e,t,r){!function(){var t=r(8),n=r(4).utf8,o=r(9),s=r(4).bin,i=function(e,r){e.constructor==String?e=r&&"binary"===r.encoding?s.stringToBytes(e):n.stringToBytes(e):o(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var a=t.bytesToWords(e),u=8*e.length,c=1732584193,f=-271733879,p=-1732584194,l=271733878,h=0;h<a.length;h++)a[h]=16711935&(a[h]<<8|a[h]>>>24)|4278255360&(a[h]<<24|a[h]>>>8);a[u>>>5]|=128<<u%32,a[(u+64>>>9<<4)+14]=u;for(var d=i._ff,y=i._gg,m=i._hh,v=i._ii,h=0;h<a.length;h+=16){var _=c,b=f,g=p,w=l;c=d(c,f,p,l,a[h+0],7,-680876936),l=d(l,c,f,p,a[h+1],12,-389564586),p=d(p,l,c,f,a[h+2],17,606105819),f=d(f,p,l,c,a[h+3],22,-1044525330),c=d(c,f,p,l,a[h+4],7,-176418897),l=d(l,c,f,p,a[h+5],12,1200080426),p=d(p,l,c,f,a[h+6],17,-1473231341),f=d(f,p,l,c,a[h+7],22,-45705983),c=d(c,f,p,l,a[h+8],7,1770035416),l=d(l,c,f,p,a[h+9],12,-1958414417),p=d(p,l,c,f,a[h+10],17,-42063),f=d(f,p,l,c,a[h+11],22,-1990404162),c=d(c,f,p,l,a[h+12],7,1804603682),l=d(l,c,f,p,a[h+13],12,-40341101),p=d(p,l,c,f,a[h+14],17,-1502002290),f=d(f,p,l,c,a[h+15],22,1236535329),c=y(c,f,p,l,a[h+1],5,-165796510),l=y(l,c,f,p,a[h+6],9,-1069501632),p=y(p,l,c,f,a[h+11],14,643717713),f=y(f,p,l,c,a[h+0],20,-373897302),c=y(c,f,p,l,a[h+5],5,-701558691),l=y(l,c,f,p,a[h+10],9,38016083),p=y(p,l,c,f,a[h+15],14,-660478335),f=y(f,p,l,c,a[h+4],20,-405537848),c=y(c,f,p,l,a[h+9],5,568446438),l=y(l,c,f,p,a[h+14],9,-1019803690),p=y(p,l,c,f,a[h+3],14,-187363961),f=y(f,p,l,c,a[h+8],20,1163531501),c=y(c,f,p,l,a[h+13],5,-1444681467),l=y(l,c,f,p,a[h+2],9,-51403784),p=y(p,l,c,f,a[h+7],14,1735328473),f=y(f,p,l,c,a[h+12],20,-1926607734),c=m(c,f,p,l,a[h+5],4,-378558),l=m(l,c,f,p,a[h+8],11,-2022574463),p=m(p,l,c,f,a[h+11],16,1839030562),f=m(f,p,l,c,a[h+14],23,-35309556),c=m(c,f,p,l,a[h+1],4,-1530992060),l=m(l,c,f,p,a[h+4],11,1272893353),p=m(p,l,c,f,a[h+7],16,-155497632),f=m(f,p,l,c,a[h+10],23,-1094730640),c=m(c,f,p,l,a[h+13],4,681279174),l=m(l,c,f,p,a[h+0],11,-358537222),p=m(p,l,c,f,a[h+3],16,-722521979),f=m(f,p,l,c,a[h+6],23,76029189),c=m(c,f,p,l,a[h+9],4,-640364487),l=m(l,c,f,p,a[h+12],11,-421815835),p=m(p,l,c,f,a[h+15],16,530742520),f=m(f,p,l,c,a[h+2],23,-995338651),c=v(c,f,p,l,a[h+0],6,-198630844),l=v(l,c,f,p,a[h+7],10,1126891415),p=v(p,l,c,f,a[h+14],15,-1416354905),f=v(f,p,l,c,a[h+5],21,-57434055),c=v(c,f,p,l,a[h+12],6,1700485571),l=v(l,c,f,p,a[h+3],10,-1894986606),p=v(p,l,c,f,a[h+10],15,-1051523),f=v(f,p,l,c,a[h+1],21,-2054922799),c=v(c,f,p,l,a[h+8],6,1873313359),l=v(l,c,f,p,a[h+15],10,-30611744),p=v(p,l,c,f,a[h+6],15,-1560198380),f=v(f,p,l,c,a[h+13],21,1309151649),c=v(c,f,p,l,a[h+4],6,-145523070),l=v(l,c,f,p,a[h+11],10,-1120210379),p=v(p,l,c,f,a[h+2],15,718787259),f=v(f,p,l,c,a[h+9],21,-343485551),c=c+_>>>0,f=f+b>>>0,p=p+g>>>0,l=l+w>>>0}return t.endian([c,f,p,l])};i._ff=function(e,t,r,n,o,s,i){var a=e+(t&r|~t&n)+(o>>>0)+i;return(a<<s|a>>>32-s)+t},i._gg=function(e,t,r,n,o,s,i){var a=e+(t&n|r&~n)+(o>>>0)+i;return(a<<s|a>>>32-s)+t},i._hh=function(e,t,r,n,o,s,i){var a=e+(t^r^n)+(o>>>0)+i;return(a<<s|a>>>32-s)+t},i._ii=function(e,t,r,n,o,s,i){var a=e+(r^(t|~n))+(o>>>0)+i;return(a<<s|a>>>32-s)+t},i._blocksize=16,i._digestsize=16,e.exports=function(e,r){if("undefined"!=typeof e){var n=t.wordsToBytes(i(e,r));return r&&r.asBytes?n:r&&r.asString?s.bytesToString(n):t.bytesToHex(n)}}}()}]);
//# sourceMappingURL=peer_custom_mesg.min.js.map